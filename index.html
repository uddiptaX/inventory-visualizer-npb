<script>
  async function loadCSV() {
    try {
      const response = await fetch('data/units.csv');
      const text = await response.text();
      const rows = text.trim().split('\n').slice(1); // Skip header
      const grouped = {};

      rows.forEach(row => {
        const [unit, status, floor] = row.split(',').map(v => v.trim());
        if (!grouped[floor]) grouped[floor] = [];
        grouped[floor].push({ unit, status });
      });

      const container = document.createElement('div');

      // Sort floors descending (10 to 1)
      Object.keys(grouped).sort((a, b) => b - a).forEach(floor => {
        const section = document.createElement('div');
        section.innerHTML = `<h3>Floor ${floor}</h3>`;
        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.flexWrap = 'wrap';
        row.style.marginBottom = '20px';

        grouped[floor].forEach(({ unit, status }) => {
          const cell = document.createElement('div');
          cell.textContent = unit;
          cell.className = status;
          cell.style.margin = '5px';
          cell.style.padding = '10px 20px';
          cell.style.borderRadius = '8px';
          row.appendChild(cell);
        });

        section.appendChild(row);
        container.appendChild(section);
      });

      document.body.appendChild(container);

    } catch (err) {
      console.error('Error loading CSV:', err);
    }
  }

  loadCSV();
</script>
